
import React, { useState, useEffect } from "react";
import { Strategy } from "@/entities/all";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Search, Target, ArrowRight, Sparkles } from "lucide-react";
import { Link } from "react-router-dom";
import { createPageUrl } from "@/utils";

export default function Strategies() {
  const [strategies, setStrategies] = useState([]);
  const [searchTerm, setSearchTerm] = useState("");

  useEffect(() => {
    loadStrategies();
  }, []);

  const loadStrategies = async () => {
    const data = await Strategy.list();
    setStrategies(data);
  };

  const defaultStrategies = [
    {
      id: 1,
      name: "N√∫meros Espelhados",
      type: "numeros_espelhados",
      description: "Estrat√©gia baseada em n√∫meros espelhados como 21,12 / 23,32 / 31,13 / 26,29. Todos esses n√∫meros s√£o espelhados, a roleta tamb√©m trabalha encima deles.",
      examples: ["21,12", "23,32", "31,13", "26,29"],
      icon: "üéØ",
      color: "from-amber-500 to-yellow-600",
      difficulty: "F√°cil",
      successRate: "85%"
    },
    {
      id: 2,
      name: "Somas e Subtra√ß√µes",
      type: "somas_subtracoes",
      description: "Estrat√©gia das somas e subtra√ß√µes dos n√∫meros passados. Sempre jogar a favor da roleta e sempre cobrir todos terminal '0'.",
      examples: ["1+3=4", "5-3=2", "9+2=11"],
      icon: "üßÆ",
      color: "from-blue-500 to-indigo-600",
      difficulty: "M√©dio",
      successRate: "78%"
    },
    {
      id: 3,
      name: "Duplos em Repeti√ß√£o",
      type: "duplos_repeticao",
      description: "Estrat√©gia dos n√∫meros duplos em repeti√ß√£o como 36,34,16,24. An√°lise de padr√µes onde n√∫meros se formam em sequ√™ncia.",
      examples: ["36,34,16", "24,34,16"],
      icon: "üîÑ",
      color: "from-purple-500 to-violet-600",
      difficulty: "Avan√ßado",
      successRate: "81%"
    },
    {
      id: 4,
      name: "Vizinhos do Zero",
      type: "vizinhos_zero",
      description: "Estrat√©gia dos vizinhos de '0'. N√∫meros como (1,5,8,11,14,23,26,32) s√£o vizinhos do zero na roleta.",
      examples: ["1,5,8,11", "14,23,26,32"],
      icon: "üé±",
      color: "from-emerald-500 to-teal-600",
      difficulty: "M√©dio",
      successRate: "88%"
    },
    {
      id: 5,
      name: "Zero Verde",
      type: "zero_verde",
      description: "Estrat√©gia do ZERO VERDE. An√°lise de sequ√™ncia de n√∫meros para identificar quando o zero est√° pr√≥ximo de sair.",
      examples: ["27,13,34,3,12", "32,23,26"],
      icon: "üíö",
      color: "from-green-500 to-emerald-600",
      difficulty: "Expert",
      successRate: "92%"
    },
    {
      id: 6,
      name: "Escada de N√∫meros",
      type: "escada_numeros",
      description: "Estrat√©gia das escadas de n√∫mero como (1,2,3) / (11,32,23) / (31,12,3). An√°lise de padr√µes em sequ√™ncia.",
      examples: ["1,2,3", "11,32,23", "31,12,3"],
      icon: "üìà",
      color: "from-orange-500 to-red-600",
      difficulty: "M√©dio",
      successRate: "75%"
    },
    {
      id: 7,
      name: "N√∫meros Repetidos",
      type: "numeros_repetidos",
      description: "Estrat√©gia de n√∫meros repetidos como (16,36,16,36). An√°lise de padr√µes onde n√∫meros espec√≠ficos tendem a repetir.",
      examples: ["16,36,16,36", "15,25,15"],
      icon: "üîÅ",
      color: "from-pink-500 to-rose-600",
      difficulty: "F√°cil",
      successRate: "83%"
    },
    {
      id: 8,
      name: "N√∫meros Multiplicados",
      type: "numeros_multiplicados",
      description: "Estrat√©gia de n√∫meros multiplicados como (3,6,9) / (2,4,6,8). Baseada em m√∫ltiplos de n√∫meros espec√≠ficos.",
      examples: ["3,6,9", "2,4,6,8"],
      icon: "‚úñÔ∏è",
      color: "from-cyan-500 to-blue-600",
      difficulty: "Avan√ßado",
      successRate: "79%"
    },
    {
      id: 9,
      name: "N√∫meros que Puxam Outros",
      type: "numeros_puxam",
      description: "An√°lise detalhada de como cada n√∫mero 'puxa' outros n√∫meros espec√≠ficos, com base em tend√™ncias e vizinhan√ßa na roleta.",
      examples: ["10 puxa 12", "9 puxa 31", "1 puxa 36"],
      icon: "üîó",
      color: "from-rose-400 to-red-500",
      difficulty: "Expert",
      successRate: "90%"
    },
    {
      id: 10,
      name: "M√©todo dos Cavalos",
      type: "cavalos",
      description: "Estrat√©gia baseada nos 'cavalos' (ex: 1-4-7, 2-5-8, 3-6-9). Cavalos se puxam e criam padr√µes de repeti√ß√£o.",
      examples: ["1-4-7", "2-5-8", "3-6-9"],
      icon: "üêé",
      color: "from-stone-400 to-stone-500",
      difficulty: "Avan√ßado",
      successRate: "84%"
    },
    {
      id: 11,
      name: "M√©todo dos G√™meos",
      type: "gemeos",
      description: "Focado nos n√∫meros g√™meos (11, 22, 33) e seus vizinhos. G√™meos puxam seus pr√≥prios terminais e vizinhos.",
      examples: ["11", "22", "33"],
      icon: "üëØ",
      color: "from-sky-400 to-sky-500",
      difficulty: "M√©dio",
      successRate: "86%"
    },
    {
      id: 12,
      name: "Irm√£os de Cores",
      type: "irmaos_cores",
      description: "Uma lista espec√≠fica de n√∫meros que se puxam com muita frequ√™ncia e facilidade. Ideal para bater metas rapidamente.",
      examples: ["8-11-9-12", "10-13-18-21"],
      icon: "üé®",
      color: "from-fuchsia-500 to-purple-600",
      difficulty: "F√°cil",
      successRate: "89%"
    },
    {
      id: 13,
      name: "Padr√µes de Cores",
      type: "padroes_cores",
      description: "An√°lise de padr√µes de cores como altern√¢ncias, repeti√ß√µes e retornos para prever a pr√≥xima cor e o green.",
      examples: ["Vermelho-Preto-Vermelho", "Vermelho-Vermelho-Vermelho"],
      icon: "‚ö´üî¥",
      color: "from-slate-400 to-slate-600",
      difficulty: "F√°cil",
      successRate: "87%"
    },
    {
      id: 14,
      name: "Padr√µes de D√∫zias/Colunas",
      type: "duzias_colunas",
      description: "Identifica√ß√£o de padr√µes de repeti√ß√£o e sequ√™ncia em d√∫zias e colunas, como 1-2-3, 1-2-1, etc.",
      examples: ["D√∫zia 1-2-3", "Coluna 1-1-2-1"],
      icon: "üî¢",
      color: "from-teal-400 to-emerald-500",
      difficulty: "Avan√ßado",
      successRate: "85%"
    },
    {
      id: 15,
      name: "Estrat√©gia dos Solit√°rios",
      type: "solitarios",
      description: "Os n√∫meros 13 e 14 s√£o 'solit√°rios'. Quando um sai com uma cor, o pr√≥ximo tende a vir na cor oposta.",
      examples: ["Saiu 13 Vermelho", "Entrar no Preto"],
      icon: "üë§",
      color: "from-gray-400 to-gray-500",
      difficulty: "F√°cil",
      successRate: "95%"
    },
    {
      id: 16,
      name: "Branco 14x (B√¥nus)",
      type: "branco_14x",
      description: "Estrat√©gia b√¥nus de alto risco e alta recompensa para acertar o branco. Baseada em sequ√™ncias espec√≠ficas que puxam o branco.",
      examples: ["5-8-10-7", "Puxa Branco"],
      icon: "üíé",
      color: "from-zinc-100 to-zinc-300",
      difficulty: "Expert",
      successRate: "Alto Risco"
    },
    {
      id: 17,
      name: "Tr√™s Soldados",
      type: "tres_soldados",
      description: "Quando tr√™s n√∫meros sequenciais saem na mesma cor, a estrat√©gia √© entrar na cor oposta, prevendo a quebra do padr√£o.",
      examples: ["Vermelho-Vermelho-Vermelho", "Entrar no Preto"],
      icon: "üõ°Ô∏è",
      color: "from-orange-500 to-red-600",
      difficulty: "M√©dio",
      successRate: "90%"
    },
    {
      id: 18,
      name: "O Grande Salto",
      type: "grande_salto",
      description: "Acontece quando vem um n√∫mero alto e logo em seguida um n√∫mero muito baixo, indicando uma aposta na cor oposta.",
      examples: ["Alto (19-36)", "Baixo (1-18)"],
      icon: "ü§∏",
      color: "from-lime-400 to-green-500",
      difficulty: "Avan√ßado",
      successRate: "89%"
    },
    {
      id: 19,
      name: "M√©todo dos N√∫meros 20",
      type: "metodo_20",
      description: "Estrat√©gia com 4 gatilhos espec√≠ficos que, ap√≥s percebidos, indicam uma entrada em todos os n√∫meros da casa dos 20.",
      examples: ["Gatilho p√≥s-5", "Gatilho p√≥s-35"],
      icon: "2Ô∏è‚É£",
      color: "from-sky-500 to-blue-600",
      difficulty: "Expert",
      successRate: "Alta"
    },
    {
      id: 20,
      name: "M√©todo dos N√∫meros 30",
      type: "metodo_30",
      description: "Padr√£o formado pela aus√™ncia e puxada de n√∫meros espec√≠ficos para entrar em todos os n√∫meros da casa dos 30.",
      examples: ["Aus√™ncia na 1¬™ linha", "22 puxa 30s"],
      icon: "3Ô∏è‚É£",
      color: "from-rose-500 to-pink-600",
      difficulty: "Expert",
      successRate: "Alta"
    },
    {
      id: 21,
      name: "Elite 2X",
      type: "elite_2x",
      description: "Estrat√©gia baseada nos gatilhos dos terminais 4 e 5 para uma entrada precisa no terminal 2 com vizinhos e prote√ß√£o.",
      examples: ["Gatilho: 4, 15", "Entrada: 2, 12, 22, 32"],
      icon: "‚ú®",
      color: "from-teal-400 to-cyan-500",
      difficulty: "M√©dio",
      successRate: "86%"
    },
    {
      id: 22,
      name: "Quarta Dimens√£o",
      type: "quarta_dimensao",
      description: "Utiliza os terminais 1 e 3 como gatilho para buscar uma entrada no terminal 4, combinando vizinhos e prote√ß√£o do zero.",
      examples: ["Gatilho: 1, 13", "Entrada: 4, 14, 24, 34"],
      icon: "üåå",
      color: "from-indigo-400 to-purple-500",
      difficulty: "Avan√ßado",
      successRate: "88%"
    },
    {
      id: 23,
      name: "F√≥rmula 5X",
      type: "formula_5x",
      description: "Acionada pelos terminais 6 e 8, esta f√≥rmula direciona a aposta para o terminal 5, com cobertura de vizinhos e do zero.",
      examples: ["Gatilho: 16, 28", "Entrada: 5, 15, 25, 35"],
      icon: "üß™",
      color: "from-lime-400 to-yellow-500",
      difficulty: "M√©dio",
      successRate: "87%"
    },
    {
      id: 24,
      name: "Alpha 6",
      type: "alpha_6",
      description: "Estrat√©gia que usa os terminais 2 e 9 como sinal para uma entrada forte no terminal 6, sempre com vizinhos e prote√ß√£o.",
      examples: ["Gatilho: 12, 19", "Entrada: 6, 16, 26, 36"],
      icon: "üê∫",
      color: "from-slate-400 to-gray-500",
      difficulty: "Avan√ßado",
      successRate: "85%"
    },
    {
      id: 25,
      name: "Padr√£o Black",
      type: "padrao_black",
      description: "Um padr√£o focado nos n√∫meros 13, 31 e 33. Quando um deles sai, a aposta √© feita neles mesmos com cobertura de vizinhos.",
      examples: ["Gatilho: 13", "Entrada: 13, 31, 33 + vizinhos"],
      icon: "‚ö´",
      color: "from-zinc-700 to-zinc-800",
      difficulty: "F√°cil",
      successRate: "90%"
    },
    {
      id: 26,
      name: "Quadrantes Ocultos",
      type: "quadrantes_ocultos",
      description: "Estrat√©gia lucrativa que usa a aus√™ncia de n√∫meros para apostar em 4 quadrantes espec√≠ficos da mesa, usando poucas fichas.",
      examples: ["Q1: 1,2,4,5", "Q2: 13,14,16,17"],
      icon: "üßä",
      color: "from-sky-400 to-blue-500",
      difficulty: "Expert",
      successRate: "Alta"
    }
  ];

  const allStrategies = [...strategies, ...defaultStrategies.filter(ds => !strategies.some(s => s.type === ds.type))];
  
  const filteredStrategies = allStrategies.filter(strategy =>
    strategy.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
    strategy.description.toLowerCase().includes(searchTerm.toLowerCase())
  );

  const getDifficultyColor = (difficulty) => {
    switch(difficulty) {
      case "F√°cil": return "bg-green-500/20 text-green-400 border-green-500/30";
      case "M√©dio": return "bg-yellow-500/20 text-yellow-400 border-yellow-500/30";
      case "Avan√ßado": return "bg-orange-500/20 text-orange-400 border-orange-500/30";
      case "Expert": return "bg-red-500/20 text-red-400 border-red-500/30";
      default: return "bg-zinc-500/20 text-zinc-400 border-zinc-500/30";
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-zinc-950 via-zinc-900 to-zinc-950 p-6">
      <div className="max-w-7xl mx-auto space-y-8">
        {/* Header */}
        <div className="text-center space-y-6">
          <div className="flex items-center justify-center gap-3 mb-6">
            <Target className="w-12 h-12 text-amber-400" />
          </div>
          <h1 className="text-4xl font-bold text-transparent bg-gradient-to-r from-amber-400 via-yellow-500 to-amber-600 bg-clip-text">
            Estrat√©gias Premium
          </h1>
          <p className="text-lg text-zinc-400 max-w-2xl mx-auto">
            Descubra e domine as estrat√©gias mais eficazes para maximizar seus ganhos na roleta
          </p>
        </div>

        {/* Search */}
        <div className="max-w-md mx-auto">
          <div className="relative">
            <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-zinc-400 w-4 h-4" />
            <Input
              placeholder="Buscar estrat√©gias..."
              value={searchTerm}
              onChange={(e) => setSearchTerm(e.target.value)}
              className="pl-10 bg-zinc-900/50 border-zinc-800 text-zinc-100 placeholder:text-zinc-500"
            />
          </div>
        </div>

        {/* Strategies Grid */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {filteredStrategies.map((strategy, index) => (
            <Card 
              key={strategy.id || index}
              className="group bg-zinc-900/30 border-zinc-800 backdrop-blur-xl hover:bg-zinc-800/50 transition-all duration-500 overflow-hidden"
            >
              <CardHeader>
                <div className="flex items-start justify-between mb-3">
                  <div className="text-3xl">{strategy.icon}</div>
                  <div className="flex flex-col gap-2">
                    <Badge className={`${getDifficultyColor(strategy.difficulty)} border text-xs`}>
                      {strategy.difficulty}
                    </Badge>
                    <Badge className={`bg-gradient-to-r ${strategy.color} text-white border-0 text-xs`}>
                      {strategy.successRate}
                    </Badge>
                  </div>
                </div>
                <CardTitle className="text-xl text-zinc-100 group-hover:text-amber-400 transition-colors">
                  {strategy.name}
                </CardTitle>
              </CardHeader>
              
              <CardContent className="space-y-4">
                <p className="text-zinc-400 text-sm leading-relaxed line-clamp-3">
                  {strategy.description}
                </p>
                
                {strategy.examples && (
                  <div className="space-y-2">
                    <h4 className="text-xs font-semibold text-zinc-500 uppercase tracking-wider">
                      Exemplos
                    </h4>
                    <div className="flex flex-wrap gap-1">
                      {strategy.examples.slice(0, 3).map((example, idx) => (
                        <Badge 
                          key={idx}
                          variant="outline" 
                          className="text-xs bg-zinc-800/50 border-zinc-700 text-zinc-300"
                        >
                          {example}
                        </Badge>
                      ))}
                      {strategy.examples.length > 3 && (
                        <Badge 
                          variant="outline" 
                          className="text-xs bg-zinc-800/50 border-zinc-700 text-zinc-400"
                        >
                          +{strategy.examples.length - 3}
                        </Badge>
                      )}
                    </div>
                  </div>
                )}
                
                <Link to={createPageUrl(`Calculator?strategy=${strategy.type}`)} className="block">
                  <Button 
                    className="w-full bg-gradient-to-r from-amber-500 to-yellow-600 hover:from-amber-600 hover:to-yellow-700 text-zinc-900 font-semibold group-hover:shadow-lg group-hover:shadow-amber-500/20 transition-all"
                  >
                    Usar Estrat√©gia
                    <ArrowRight className="w-4 h-4 ml-2" />
                  </Button>
                </Link>
              </CardContent>
            </Card>
          ))}
        </div>

        {filteredStrategies.length === 0 && (
          <div className="text-center py-12">
            <Sparkles className="w-16 h-16 text-zinc-600 mx-auto mb-4" />
            <h3 className="text-xl font-semibold text-zinc-400 mb-2">
              Nenhuma estrat√©gia encontrada
            </h3>
            <p className="text-zinc-500">
              Tente buscar com outros termos ou explore todas as estrat√©gias dispon√≠veis.
            </p>
          </div>
        )}
      </div>
    </div>
  );
}
